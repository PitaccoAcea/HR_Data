{% load menu_tags %}

<!-- Menu dinamico per base.html -->
<div class="topstrip">
  <div class="topstrip-inner">
    <ul class="breadcrumb-menu">
      {% for item in menu_items %}
        <li class="menu-item {{ 0|get_menu_level_class }}">
          <a href="{{ item.get_url }}" 
             class="menu-link {% if item.is_dropdown %}dropdown-parent{% endif %}">
            {% if item.icona %}
              {{ item.icona|menu_icon_html|safe }}
            {% endif %}
            {{ item.titolo }}
          </a>
          
          {% if item.is_dropdown %}
            <!-- Dropdown per sottomenÃ¹ -->
            <div class="dropdown-menu">
              {% include 'accounts/menu_dropdown_recursive.html' with children=item.figli_filtered level=1 %}
            </div>
          {% endif %}
          
          {% if not forloop.last %}<span class="sep">â€º</span>{% endif %}
        </li>
      {% empty %}
        <li><a href="/">Home</a></li>
      {% endfor %}
    </ul>

    <div class="user-area">
      {% if request.user.is_authenticated %}
        {% with request.user.username|cut:"TI\\" as nome_utente %}
          ðŸ‘¤ {{ nome_utente }}
        {% endwith %}
      {% else %}
        ðŸ‘¤ Utente non autenticato
      {% endif %}
    </div>
  </div>
</div>

<!-- CSS per il menÃ¹ dropdown -->
<style>
.topstrip {
  position: relative;
}

.breadcrumb-menu {
  position: relative;
}

.menu-item {
  position: relative;
  display: inline-block;
}

.menu-link {
  text-decoration: none;
  padding: 8px 12px;
  display: inline-block;
  border-radius: 4px;
  transition: background-color 0.3s;
}

.menu-link:hover {
  background-color: rgba(0,0,0,0.1);
}

.menu-link i {
  margin-right: 5px;
}

.dropdown-parent::after {
  content: " â–¼";
  font-size: 0.8em;
  margin-left: 5px;
}

.dropdown-menu {
  position: absolute;
  top: 100%;
  left: 0;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  min-width: 200px;
  z-index: 1000;
  display: none;
}

.menu-item:hover .dropdown-menu {
  display: block;
}

.dropdown-item {
  display: block;
  padding: 8px 15px;
  text-decoration: none;
  color: #333;
  border-bottom: 1px solid #eee;
}

.dropdown-item:hover {
  background-color: #f8f9fa;
  color: #333;
}

.dropdown-item:last-child {
  border-bottom: none;
}

.dropdown-item i {
  margin-right: 8px;
  width: 16px;
  text-align: center;
}

.menu-level-1 .dropdown-item {
  padding-left: 15px;
}

.menu-level-2 .dropdown-item {
  padding-left: 30px;
}

.menu-level-3 .dropdown-item {
  padding-left: 45px;
}
</style>